---
title: Filtering and Ignore Rules  
description: Control which files Refaktor processes with includes, excludes, and ignore rules
---

Refaktor provides powerful filtering options to control exactly which files get processed during refactoring operations.

## Default Behavior (Respects .gitignore)

By default, Refaktor respects standard ignore mechanisms:

- **`.gitignore` files** at all levels
- **`.git/info/exclude`** (repository-specific ignores)
- **Global git ignore rules** (`~/.gitignore_global`, etc.)
- **`.rgignore` files** (ripgrep-specific ignore files)
- **Hidden files and directories** are skipped (starting with `.`)

This means Refaktor won't process files in `node_modules/`, `target/`, `.git/`, etc. by default.

## Unrestricted Mode

Use ripgrep-style unrestricted flags to reduce filtering:

### `-u` (Unrestricted Level 1)
Disables `.gitignore` files but respects other ignore mechanisms:

```bash
refaktor plan old_name new_name -u
```

- ✅ Processes files ignored by `.gitignore`
- ❌ Still respects `.git/info/exclude` and global git ignore
- ❌ Still skips hidden files
- ❌ Still skips binary files

### `-uu` (Unrestricted Level 2)
Disables all ignore files and shows hidden files:

```bash
refaktor plan old_name new_name -uu
```

- ✅ Processes all ignore files
- ✅ Shows hidden files and directories
- ❌ Still skips binary files

### `-uuu` (Unrestricted Level 3)
Processes everything, including binary files:

```bash
refaktor plan old_name new_name -uuu
```

- ✅ Processes all files
- ✅ Shows hidden files and directories  
- ✅ Treats binary files as text (dangerous!)

**⚠️ Warning**: Level 3 can corrupt binary files. Use with extreme caution.

## Include Patterns

Use glob patterns to specify exactly which files to process:

### Single Pattern
```bash
# Only process Rust source files
refaktor plan old_name new_name --include "**/*.rs"

# Only process files in src/ directory
refaktor plan old_name new_name --include "src/**"
```

### Multiple Patterns
```bash
# Process Rust and TypeScript files
refaktor plan old_name new_name --include "**/*.rs,**/*.ts,**/*.tsx"

# Process specific directories
refaktor plan old_name new_name --include "src/**,lib/**,tests/**"
```

## Exclude Patterns

Skip specific files or directories:

### Common Exclusions
```bash
# Exclude test files
refaktor plan old_name new_name --exclude "**/*test*"

# Exclude build outputs and dependencies
refaktor plan old_name new_name --exclude "target/**,node_modules/**,dist/**"

# Exclude specific file types
refaktor plan old_name new_name --exclude "**/*.min.js,**/*.bundle.js"
```

### Combining Include and Exclude
```bash
# Process TypeScript files but skip tests and node_modules
refaktor plan old_name new_name \
  --include "**/*.ts,**/*.tsx" \
  --exclude "**/*test*,node_modules/**"
```

## Exclude Specific Matches

Use `--exclude-match` to skip specific compound words or identifiers that match your pattern but shouldn't be changed:

```bash
# Skip specific compound words that contain your pattern
refaktor plan foo bar --exclude-match bazFooQux,FooService

# Useful when a pattern accidentally matches unintended identifiers  
refaktor rename config settings --exclude-match ConfigurationManager
```

This is particularly useful when:
- Your pattern matches part of a larger compound word
- Certain identifiers contain your pattern but have different meanings
- You want to be very selective about what gets changed

## Glob Pattern Syntax

Refaktor uses standard glob patterns:

| Pattern | Matches |
|---------|---------|
| `*` | Any filename (not directories) |
| `**` | Any number of directories |
| `?` | Single character |
| `[abc]` | Any character in brackets |
| `[!abc]` | Any character not in brackets |
| `{a,b,c}` | Any of the comma-separated alternatives |

### Examples
```bash
# All JavaScript files recursively
"**/*.js"

# All files in src/ and lib/ directories  
"{src,lib}/**"

# TypeScript files but not declaration files
"**/*.ts" --exclude "**/*.d.ts"

# Files starting with 'test' or 'spec'
"**/{test,spec}*"
```

## Binary File Handling

Refaktor automatically detects and skips binary files by default:

### Detection Methods
- **File extension**: `.jpg`, `.png`, `.exe`, etc.
- **Content analysis**: Checks for null bytes and non-UTF8 content
- **Magic numbers**: Recognizes common binary file headers

### Override Binary Detection
```bash
# Force processing of all files (dangerous!)
refaktor plan old_name new_name -uuu

# Include specific binary extensions (not recommended)
refaktor plan old_name new_name --include "**/*.{bin,dat}"
```

## Auto-Initialization

Refaktor automatically prompts to ignore its workspace directory on first use:

### Interactive Prompt
```
Refaktor uses .refaktor/ for plans, backups, and history.
Ignore it now?
  [Y] Repo .gitignore   [l] Local .git/info/exclude   [g] Global excludesfile   [n] No
Choice (Y/l/g/n): 
```

### Command-Line Control
```bash
# Automatically add to .gitignore without prompting
refaktor --auto-init=repo plan old new

# Prevent any auto-initialization
refaktor --no-auto-init plan old new

# Use -y for non-interactive environments (CI)
refaktor -y plan old new
```

## Performance Tips

### Optimize Large Codebases
```bash
# Be specific with includes to avoid scanning unnecessary files
refaktor plan old new --include "src/**/*.{js,ts,tsx}"

# Exclude large directories early
refaktor plan old new --exclude "node_modules/**,target/**,.git/**"
```

### Parallel Processing
Refaktor automatically uses parallel directory traversal and file processing for optimal performance on large codebases.

## Common Patterns

### Frontend Projects
```bash
# React/TypeScript project
refaktor rename oldName newName \
  --include "src/**/*.{ts,tsx,js,jsx}" \
  --exclude "**/*.test.*,**/__tests__/**,node_modules/**"
```

### Rust Projects  
```bash
# Rust project with tests
refaktor rename old_name new_name \
  --include "**/*.rs" \
  --exclude "target/**"
```

### Python Projects
```bash  
# Python with tests in separate directory
refaktor rename old_name new_name \
  --include "**/*.py" \
  --exclude "venv/**,__pycache__/**,*.pyc"
```

### Documentation Only
```bash
# Only process markdown and text files
refaktor rename old_name new_name \
  --include "**/*.{md,txt,rst}" 
```
